@{
    ViewBag.Title = "Tổng quan";
    Layout = "~/Views/Shared/_adminLayout.cshtml";
}
@using BanDoAn.Models

<div class="row justify-content-center">
    <!-- Hiển thị bảng Top 5 full chiều rộng hoặc căn giữa -->
    <div class="col-lg-10">
        <div class="chart-container border bg-white rounded-4 shadow-sm h-100" style="padding: 0; overflow: hidden;">
            <div class="p-4 border-bottom bg-light d-flex justify-content-between align-items-center">
                <h5 class="fw-bold text-secondary mb-0"><i class="fas fa-crown me-2 text-warning"></i>Top 5 Món Bán Chạy Nhất</h5>
                <a href="@Url.Action("QLThucDon", "Admin")" class="btn btn-sm btn-outline-primary rounded-pill">Quản lý thực đơn</a>
            </div>
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="bg-light text-secondary small text-uppercase">
                        <tr>
                            <th class="ps-4 py-3">Sản phẩm</th>
                            <th class="text-center">Số lượng đã bán</th>
                            <th class="text-end pe-4">Tổng doanh thu</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (ViewBag.TopSanPham != null)
                        {
                            // Ép kiểu rõ ràng sang IEnumerable<TopSanPhamModel>
                            foreach (var item in ViewBag.TopSanPham as IEnumerable<TopSanPhamModel>)
                            {
                                <tr>
                                    <td class="ps-4 py-3">
                                        <div class="d-flex align-items-center">
                                            <!-- Thêm onerror để xử lý ảnh lỗi -->
                                            <img src="@Url.Content("~/Content/images/" + item.AnhBia)"
                                                 class="rounded-3 me-3 object-fit-cover shadow-sm border" width="50" height="50"
                                                 onerror="this.src='https://placehold.co/50x50?text=Img'">
                                            <div>
                                                <div class="fw-bold text-dark fs-6">@item.TenSP</div>
                                                <div class="text-muted small">@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0} đ", item.GiaBan)</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="text-center">
                                        <span class="badge bg-primary bg-opacity-10 text-primary rounded-pill px-4 py-2 fs-6">@item.DaBan</span>
                                    </td>
                                    <td class="text-end pe-4 fw-bold text-secondary fs-6">
                                        @String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", item.TongTien)
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="3" class="text-center py-5 text-muted">Chưa có dữ liệu bán hàng</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>